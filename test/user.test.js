const {
  deployments: { fixture },
  ethers,
} = require("hardhat");

const { WMATIC, fromWei, DAI, USDC, USDT } = require("../deploy/utils");

const USER = "0x9aE80b1C3E379a8844B37FD588E04AF0a8Fc3496";
const REGISTRY = "0x583B965462e11Da63D1d4bC6D2d43d391F79af1f";

contract("User Debugging", ([]) => {
  before(async function () {
    await network.provider.request({
      method: "hardhat_reset",
      params: [
        {
          forking: {
            jsonRpcUrl: process.env.NODE_URL,
          },
        },
      ],
    });

    await hre.network.provider.request({
      method: "hardhat_impersonateAccount",
      params: [USER],
    });

    userSigner = await ethers.provider.getSigner(USER);

    registry = await ethers.getContractAt("EthaRegistry", REGISTRY);

    const _wallet = await registry.wallets(USER);

    wallet = await ethers.getContractAt("SmartWallet", _wallet, userSigner);
  });

  it("should trigger transaction", async function () {
    const targets = [
      "0x01A3a30da17dd33813611631B0491731944150f7",
      "0xdA3B84867B9e78026D523d7717fb83d93c90B378",
      "0xe8dd7766f476Af2d0676429567B7e39c3FF358C0",
    ];
    const datas = [
      "0xb5c5f6720000000000000000000000008de8637412e70916ee2caa3b62c569d9a88391a3000000000000000000000000000000000000000000000000000000000005f4b80000000000000000000000000000000000000000000000000000000000000000",
      "0x3145cbb40000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa84174000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f0000000000000000000000002cf7252e74036d1da831d11089d326296e64a728000000000000000000000000000000000000000000000000000000000005f4b80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001",
      "0x4846220e000000000000000000000000445fe580ef8d70ff569ab36e80c647af338db351000000000000000000000000c2132d05d31c914a87c6611c10748aeb04b58e8f0000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa841740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001",
    ];
    await wallet.execute(targets, datas);
  });
});
